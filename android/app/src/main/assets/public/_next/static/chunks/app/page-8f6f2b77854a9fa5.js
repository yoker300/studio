(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{9144:(e,s,t)=>{Promise.resolve().then(t.bind(t,9971))},9971:(e,s,t)=>{"use strict";t.d(s,{default:()=>sj});var a=t(5155),r=t(2115),n=t(1860),l=t(5253),i=t(4206),d=t(3063),c=t(4269);let o=()=>{let e=(0,r.useContext)(n.B);if(!e)return null;let{activeTab:s,navigate:t}=e,o=[{name:"lists",icon:l.A,label:"Lists",color:"text-primary"},{name:"recipes",icon:i.A,label:"Recipes",color:"text-primary"},{name:"settings",icon:d.A,label:"Settings",color:"text-primary"}];return(0,a.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-card/80 backdrop-blur-sm border-t",children:(0,a.jsx)("div",{className:"flex justify-around max-w-md mx-auto",children:o.map(e=>{let r=s===e.name;return(0,a.jsxs)("button",{onClick:()=>t({type:e.name}),className:(0,c.cn)("flex flex-col items-center justify-center p-3 w-24 text-muted-foreground hover:bg-accent hover:text-accent-foreground transition-colors",r&&"bg-accent/50 ".concat(e.color," font-semibold")),children:[(0,a.jsx)(e.icon,{className:"w-6 h-6 mb-1"}),(0,a.jsx)("span",{className:"text-xs",children:e.label})]},e.name)})})})},m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});m.displayName="Card";let x=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",t),...r})});x.displayName="CardHeader";let u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});u.displayName="CardTitle";let h=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,c.cn)("text-sm text-muted-foreground",t),...r})});h.displayName="CardDescription";let f=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,c.cn)("p-6 pt-0",t),...r})});f.displayName="CardContent";let p=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,c.cn)("flex items-center p-6 pt-0",t),...r})});p.displayName="CardFooter";var j=t(7129),g=t(3101);let N=(0,g.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),v=r.forwardRef((e,s)=>{let{className:t,variant:r,size:n,asChild:l=!1,...i}=e,d=l?j.DX:"button";return(0,a.jsx)(d,{className:(0,c.cn)(N({variant:r,size:n,className:t})),ref:s,...i})});v.displayName="Button";var b=t(4640),y=t(7870);let w=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(y.bL,{ref:s,className:(0,c.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r})});w.displayName=y.bL.displayName;let k=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(y._V,{ref:s,className:(0,c.cn)("aspect-square h-full w-full",t),...r})});k.displayName=y._V.displayName;let C=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(y.H4,{ref:s,className:(0,c.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r})});C.displayName=y.H4.displayName;var A=t(8042);let I=e=>{let{list:s}=e,t=(0,r.useContext)(n.B);if(!t)return null;let{user:l}=(0,A.useUser)(),{navigate:i,users:d}=t,c=s.items.length,o=s.items.filter(e=>e.checked).length,h=d.find(e=>e.uid===s.ownerId),p=s.collaborators.map(e=>d.find(s=>s.uid===e)).filter(Boolean),j=(null==l?void 0:l.uid)===s.ownerId;return(0,a.jsxs)(m,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>i({type:"listDetail",listId:s.id}),children:[(0,a.jsxs)(x,{className:"flex flex-row items-start justify-between pb-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)(u,{className:"flex items-center gap-3 text-2xl font-headline",children:[(0,a.jsx)("span",{className:"text-4xl",children:s.icon}),s.name]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[h&&(0,a.jsxs)(w,{className:"h-6 w-6",children:[(0,a.jsx)(k,{src:h.photoURL,alt:h.name}),(0,a.jsx)(C,{children:h.name.charAt(0)})]}),p.map(e=>e&&(0,a.jsxs)(w,{className:"h-6 w-6 border-2 border-background",children:[(0,a.jsx)(k,{src:e.photoURL,alt:e.name}),(0,a.jsx)(C,{children:e.name.charAt(0)})]},e.uid))]})]}),j&&(0,a.jsx)(v,{variant:"ghost",size:"icon",onClick:e=>{e.stopPropagation(),i({type:"editList",listId:s.id})},children:(0,a.jsx)(b.A,{className:"h-5 w-5"})})]}),(0,a.jsxs)(f,{children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:c>0?"".concat(o," of ").concat(c," items checked"):"No items yet"}),c>0&&(0,a.jsx)("div",{className:"w-full bg-muted rounded-full h-2.5 mt-2",children:(0,a.jsx)("div",{className:"bg-primary h-2.5 rounded-full transition-all",style:{width:"".concat(o/c*100,"%")}})})]})]})};var R=t(2265);let S=()=>{let e=(0,r.useContext)(n.B);if(!e)return null;let{lists:s,navigate:t}=e;return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("header",{className:"mb-6",children:(0,a.jsx)("h1",{className:"text-4xl font-headline font-bold",children:"Your Lists"})}),0===s.length?(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"You don't have any lists yet."}),(0,a.jsxs)(v,{onClick:()=>t({type:"addList"}),children:[(0,a.jsx)(R.A,{className:"-ml-1 mr-2 h-5 w-5"}),"Create Your First List"]})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:s.map(e=>(0,a.jsx)(I,{list:e},e.id))}),(0,a.jsx)("div",{className:"fixed bottom-24 right-4",children:(0,a.jsx)(v,{size:"icon",className:"rounded-full h-14 w-14 shadow-lg",onClick:()=>t({type:"addList"}),children:(0,a.jsx)(R.A,{className:"h-6 w-6"})})})]})};var z=t(8162),L=t(2251);let M=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(z.bL,{ref:s,className:(0,c.cn)("peer h-4 w-4 shrink-0 rounded-full border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,a.jsx)(z.C1,{className:(0,c.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(L.A,{className:"h-4 w-4"})})})});M.displayName=z.bL.displayName;let q=(0,g.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function U(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,c.cn)(q({variant:t}),s),...r})}var E=t(5996);let D=e=>{let{item:s,listId:t,onEdit:l}=e,i=(0,r.useContext)(n.B);if(!i)return null;let{toggleItemChecked:d}=i,o=[s.unit,s.store,s.notes].filter(Boolean).join(", ");return(0,a.jsx)(m,{onClick:l,className:(0,c.cn)("transition-all duration-300",s.checked?"bg-muted/50 opacity-60":"bg-card",s.urgent&&!s.checked&&"border-primary"),children:(0,a.jsxs)(f,{className:"p-3 flex items-start gap-3",children:[(0,a.jsx)(M,{id:"item-".concat(s.id),checked:s.checked,onClick:e=>e.stopPropagation(),onCheckedChange:()=>d(t,s.id),className:"mt-1 h-6 w-6"}),(0,a.jsxs)("div",{className:"flex-1 grid gap-1",onClick:l,children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("span",{className:"text-xl",children:s.icon}),(0,a.jsx)("span",{className:(0,c.cn)("font-medium",s.checked&&"line-through",s.urgent&&!s.checked&&"text-primary font-bold"),children:s.name}),s.qty>1&&(0,a.jsxs)(U,{variant:"secondary",children:["x",s.qty]}),s.gf&&(0,a.jsxs)(U,{variant:"outline",className:"text-green-700 dark:text-green-300 border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/30",children:[(0,a.jsx)(E.A,{className:"h-3 w-3 mr-1"})," GF"]})]}),o&&(0,a.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400 pl-8",children:(0,a.jsx)("p",{children:o})})]})]})})};var Y=t(6204),B=t(8771),H=t(3672),P=t(1480),O=t(9338),F=t(2544),J=t(6942),T=t(5653),_=t(7283),G=t(6615);let V=_.bL;_.l9;let Q=_.ZL,Z=_.bm,W=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(_.hJ,{ref:s,className:(0,c.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});W.displayName=_.hJ.displayName;let X=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(Q,{children:[(0,a.jsx)(W,{}),(0,a.jsxs)(_.UC,{ref:s,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[r,(0,a.jsxs)(_.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(G.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});X.displayName=_.UC.displayName;let K=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};K.displayName="DialogHeader";let $=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};$.displayName="DialogFooter";let ee=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(_.hE,{ref:s,className:(0,c.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})});ee.displayName=_.hE.displayName;let es=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(_.VY,{ref:s,className:(0,c.cn)("text-sm text-muted-foreground",t),...r})});es.displayName=_.VY.displayName;let et=r.forwardRef((e,s)=>{let{className:t,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,c.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","rtl:text-right",t),ref:s,...n})});et.displayName="Input";let ea=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("textarea",{className:(0,c.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","rtl:text-right",t),ref:s,...r})});ea.displayName="Textarea";var er=t(8503),en=t(5894);let el=T.Ik({icon:T.Yj().min(1,"Icon is required."),name:T.Yj().min(1,"Item name cannot be empty."),qty:T.ai().min(.01,"Quantity must be greater than 0."),unit:T.Yj().optional(),store:T.Yj().optional(),notes:T.Yj().optional(),urgent:T.zM(),gf:T.zM()});function ei(e){let{isOpen:s,onClose:t,item:l,listId:i}=e,d=(0,r.useContext)(n.B),{toast:o}=(0,en.dj)(),[m,x]=(0,r.useState)(!1),u=(0,r.useRef)(null),{control:h,handleSubmit:f,reset:p,watch:j,setValue:g}=(0,F.mN)({resolver:(0,J.u)(el),defaultValues:{icon:"\uD83D\uDED2",name:"",qty:1,unit:"",store:"",notes:"",urgent:!1,gf:!1}});if((0,r.useEffect)(()=>{s&&(x(!1),l?(p({icon:l.icon||"\uD83D\uDED2",name:l.name,qty:l.qty,unit:l.unit,store:l.store,notes:l.notes,urgent:l.urgent,gf:l.gf}),setTimeout(()=>{var e;return null==(e=u.current)?void 0:e.focus()},100)):p({icon:"\uD83D\uDED2",name:"",qty:1,unit:"",store:"",notes:"",urgent:!1,gf:!1}))},[l,s,p]),!d)return null;let{addItemToList:N,updateItemInList:b,settings:y}=d,w=j("name"),k=j("qty"),C=j("urgent"),A=j("gf"),I=y.smartQuantities.find(e=>w.toLowerCase().includes(e.itemName.toLowerCase()));return(0,a.jsx)(V,{open:s,onOpenChange:e=>!e&&t(),children:(0,a.jsx)(X,{className:"sm:max-w-md p-4",children:(0,a.jsxs)("form",{onSubmit:f(e=>{x(!0);let s={...e,category:(null==l?void 0:l.category)||"",unit:e.unit||"",notes:e.notes||"",store:e.store||""};l?(b(i,{...l,...s}),o({title:"Item Update Queued",description:'"'.concat(e.name,'" will be processed.')})):(N(i,{...s,checked:!1}),o({title:"Item Added to Queue",description:'"'.concat(e.name,'" will be processed.')})),t()}),children:[(0,a.jsx)(K,{children:(0,a.jsx)(ee,{children:l?"Edit Item":"Add Item"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 my-3",children:[(0,a.jsx)(F.xI,{name:"icon",control:h,render:e=>{let{field:s}=e;return(0,a.jsx)(et,{...s,className:"text-3xl w-14 h-14 p-0 text-center bg-muted",maxLength:2})}}),(0,a.jsx)(F.xI,{name:"name",control:h,render:e=>{let{field:s}=e;return(0,a.jsx)(et,{...s,ref:u,placeholder:"Item Name",className:"text-2xl font-headline font-bold h-14 flex-1"})}})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"p-2 bg-muted rounded-lg",children:[(0,a.jsx)("label",{className:"text-sm font-bold text-foreground",children:"Quantity"}),I?(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-2 mt-2",children:[I.quantities.map(e=>(0,a.jsx)(v,{type:"button",variant:k===e?"default":"outline",onClick:()=>g("qty",e),children:e},e)),(0,a.jsx)(et,{type:"number",value:k,onChange:e=>g("qty",parseInt(e.target.value)||1),className:"col-span-1"})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)(v,{type:"button",size:"icon",variant:"outline",onClick:()=>g("qty",Math.max(1,k-1)),children:(0,a.jsx)(er.A,{className:"h-4 w-4"})}),(0,a.jsx)(F.xI,{name:"qty",control:h,render:e=>{let{field:s}=e;return(0,a.jsx)(et,{...s,type:"number",step:"0.1",className:"w-20 text-center text-lg",onChange:e=>s.onChange(parseFloat(e.target.value)||0)})}}),(0,a.jsx)(v,{type:"button",size:"icon",variant:"outline",onClick:()=>g("qty",k+1),children:(0,a.jsx)(R.A,{className:"h-4 w-4"})}),(0,a.jsx)(F.xI,{name:"unit",control:h,render:e=>{let{field:s}=e;return(0,a.jsx)(et,{...s,placeholder:"Unit (g, ml, cup...)",className:"flex-1"})}})]})]}),(0,a.jsxs)("div",{className:"p-2 bg-muted rounded-lg",children:[(0,a.jsx)("label",{className:"text-sm font-bold text-foreground",children:"Store"}),(0,a.jsx)(F.xI,{name:"store",control:h,render:e=>{let{field:s}=e;return(0,a.jsx)(et,{...s,placeholder:"Any Store",className:"mt-1 bg-background"})}}),(0,a.jsx)("div",{className:"flex gap-2 overflow-x-auto mt-2 pb-2",children:y.storePresets.map(e=>(0,a.jsx)(v,{type:"button",size:"sm",variant:"outline",className:"shrink-0",onClick:()=>g("store",e),children:e},e))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(v,{type:"button",variant:C?"destructive":"outline",className:"h-14 flex flex-col gap-1",onClick:()=>g("urgent",!C),children:[(0,a.jsx)(P.A,{size:20})," Urgent"]}),(0,a.jsxs)(v,{type:"button",variant:A?"secondary":"outline",className:(0,c.cn)("h-14 flex flex-col gap-1",A&&"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300"),onClick:()=>g("gf",!A),children:[(0,a.jsx)(E.A,{size:20})," Gluten Free"]})]}),(0,a.jsx)(F.xI,{name:"notes",control:h,render:e=>{let{field:s}=e;return(0,a.jsx)(ea,{...s,placeholder:"Notes (e.g., Brand X, low fat)...",rows:2})}})]}),(0,a.jsxs)($,{className:"mt-4 sm:justify-between gap-2",children:[(0,a.jsx)(Z,{asChild:!0,children:(0,a.jsx)(v,{type:"button",variant:"secondary",children:"Cancel"})}),(0,a.jsx)(v,{type:"submit",disabled:m,children:m?"Saving...":l?"Save Changes":"Add Item"})]})]})})})}var ed=t(45),ec=t(5212),eo=t(489);let em=(0,g.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ex=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eo.b,{ref:s,className:(0,c.cn)(em(),t),...r})});ex.displayName=eo.b.displayName;let eu=window.SpeechRecognition||window.webkitSpeechRecognition;function eh(e){let{isOpen:s,onClose:t,listId:l}=e,i=(0,r.useContext)(n.B),[d,c]=(0,r.useState)(!1),[o,m]=(0,r.useState)(""),[x,u]=(0,r.useState)(!1),[h,f]=(0,r.useState)("input"),[p,j]=(0,r.useState)([]),[g,N]=(0,r.useState)({}),{toast:b}=(0,en.dj)(),y=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!eu)return;let e=new eu;e.continuous=!0,e.interimResults=!0,e.lang="en-US",e.onresult=e=>{let s="",t="";for(let a=e.resultIndex;a<e.results.length;++a)e.results[a].isFinal?t+=e.results[a][0].transcript:s+=e.results[a][0].transcript;m(t+s)},e.onerror=e=>{console.error("Speech recognition error",e.error),b({variant:"destructive",title:"Voice Error",description:"Could not recognize voice: ".concat(e.error)}),c(!1)},e.onend=()=>{c(!1)},y.current=e},[b]);let w=()=>{var e,s;if(!eu)return void b({variant:"destructive",title:"Unsupported",description:"Voice recognition is not supported in your browser."});d?null==(e=y.current)||e.stop():(m(""),null==(s=y.current)||s.start()),c(!d),null==i||i.vibrate()},k=async()=>{if(i&&o){i.vibrate(),u(!0);try{var e;let s=await fetch("/api/smart-add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({voiceInput:o})});if(!s.ok){let e=await s.json();throw Error(e.error||"Could not parse items from your input.")}let t=await s.json();if(!t||0===t.length){b({variant:"destructive",title:"No Items Found",description:"The AI couldn't find any items in your text."}),u(!1);return}if(1===t.length&&((null==(e=t[0].category)?void 0:e.toLowerCase().includes("recipe"))||o.toLowerCase().includes("recipe for")))j(t),f("ask_breakdown");else{j(t);let e=t.reduce((e,s,t)=>(e[t]=!0,e),{});N(e),f("confirm")}}catch(e){console.error("AI parsing failed:",e),b({variant:"destructive",title:"AI Error",description:e.message||"Could not parse items from your input."})}finally{u(!1)}}},C=async()=>{u(!0);try{let e=p[0].name,s=await fetch("/api/break-down-recipe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recipeName:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Could not break down the recipe.")}let t=await s.json();if(!t||0===t.length){b({variant:"destructive",title:"Breakdown Failed",description:"Could not break down the recipe."}),A();return}j(t);let a=t.reduce((e,s,t)=>(e[t]=!0,e),{});N(a),f("confirm_ingredients")}catch(e){console.error("AI recipe breakdown failed:",e),b({variant:"destructive",title:"AI Error",description:e.message||"Could not break down recipe."}),A()}finally{u(!1)}},A=()=>{j(p),N(p.reduce((e,s,t)=>(e[t]=!0,e),{})),f("confirm")},I=()=>{if(!i)return;i.vibrate();let e=p.filter((e,s)=>g[s]);if(0===e.length){b({title:"No items selected."}),R();return}for(let s of e)i.addSmartItemToList(l,{name:s.name,qty:s.qty||1,category:s.category||"Other",icon:s.icon||"\uD83D\uDED2",urgent:s.urgent||!1,gf:!1,notes:s.notes||"",store:""});b({title:"Items Queued",description:"Processing ".concat(e.length," items for your list.")}),R()},R=()=>{m(""),c(!1),u(!1),j([]),N({}),f("input"),t()};return(0,a.jsx)(V,{open:s,onOpenChange:e=>!e&&R(),children:(0,a.jsx)(X,{children:(()=>{switch(h){case"ask_breakdown":return(0,a.jsxs)("div",{children:[(0,a.jsxs)(K,{children:[(0,a.jsxs)(ee,{className:"flex items-center gap-2",children:[(0,a.jsx)(ed.A,{})," Recipe Detected"]}),(0,a.jsxs)(es,{children:['It looks like "',p[0].name,'" is a recipe. Would you like to break it down into ingredients?']})]}),(0,a.jsxs)($,{className:"mt-4 grid grid-cols-2 gap-2",children:[(0,a.jsxs)(v,{variant:"outline",onClick:A,disabled:x,children:[(0,a.jsx)(G.A,{className:"mr-2 h-4 w-4"})," No, Add as is"]}),(0,a.jsx)(v,{onClick:C,disabled:x,children:x?"Breaking down...":(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(L.A,{className:"mr-2 h-4 w-4"})," Yes, break it down"]})})]})]});case"confirm":case"confirm_ingredients":return(0,a.jsxs)("div",{children:[(0,a.jsxs)(K,{children:[(0,a.jsx)(ee,{children:"Confirm Items"}),(0,a.jsx)(es,{children:"Select the items you want to add to your list."})]}),(0,a.jsx)("div",{className:"my-4 space-y-2 max-h-64 overflow-y-auto",children:p.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2 p-2 rounded-md bg-muted",children:[(0,a.jsx)(M,{id:"item-".concat(s),checked:g[s],onCheckedChange:e=>N(t=>({...t,[s]:!!e}))}),(0,a.jsxs)(ex,{htmlFor:"item-".concat(s),className:"flex-1 text-base",children:[e.icon," ",e.name," ",e.qty&&e.qty>1?"(x".concat(e.qty,")"):""]})]},s))}),(0,a.jsxs)($,{children:[(0,a.jsx)(v,{variant:"outline",onClick:R,children:"Cancel"}),(0,a.jsx)(v,{onClick:I,children:"Add Selected Items"})]})]});default:return(0,a.jsxs)("div",{children:[(0,a.jsxs)(K,{children:[(0,a.jsxs)(ee,{className:"flex items-center gap-2",children:[(0,a.jsx)(O.A,{className:"text-accent-foreground"}),"AI Smart Add"]}),(0,a.jsx)(es,{children:'Use your voice or type to add items. e.g., "6 eggs and milk" or "a recipe for lasagna".'})]}),(0,a.jsxs)("div",{className:"relative my-4",children:[(0,a.jsx)(ea,{placeholder:d?"Listening...":"Tap the mic to start or type here...",value:o,onChange:e=>m(e.target.value),rows:5}),(0,a.jsx)(v,{size:"icon",onClick:w,className:"absolute bottom-2 right-2 rounded-full ".concat(d?"bg-red-500 hover:bg-red-600":""),children:(0,a.jsx)(ec.A,{})})]}),(0,a.jsxs)($,{children:[(0,a.jsx)(v,{variant:"outline",onClick:R,children:"Cancel"}),(0,a.jsx)(v,{onClick:k,disabled:!o||x,children:x?"Parsing...":"Parse Items"})]})]})}})()})})}function ef(e){let{isOpen:s,onClose:t,entityType:l,entityId:i,ownerId:d,collaborators:c}=e,o=(0,r.useContext)(n.B),[m,x]=(0,r.useState)(""),[u,h]=(0,r.useState)(!1),{user:f}=(0,A.useUser)(),p=(null==f?void 0:f.uid)===d,j=async()=>{o&&m&&(h(!0),await o.addCollaborator(l,i,m)&&x(""),h(!1))};return(0,a.jsx)(V,{open:s,onOpenChange:t,children:(0,a.jsxs)(X,{children:[(0,a.jsxs)(K,{children:[(0,a.jsxs)(ee,{children:["Share this ",l]}),(0,a.jsxs)(es,{children:["Invite others to view and edit this ",l,"."]})]}),p&&(0,a.jsxs)("div",{className:"flex w-full max-w-sm items-center space-x-2 my-4",children:[(0,a.jsx)(et,{type:"email",placeholder:"friend@example.com",value:m,onChange:e=>x(e.target.value)}),(0,a.jsx)(v,{type:"submit",onClick:j,disabled:u,children:u?"Adding...":"Add"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Collaborators"}),(0,a.jsxs)("div",{className:"space-y-2 rounded-md border p-2",children:[c.map(e=>e&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(w,{className:"h-8 w-8",children:[(0,a.jsx)(k,{src:e.photoURL,alt:e.name}),(0,a.jsx)(C,{children:e.name.charAt(0)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.email})]})]}),p&&e.uid!==d&&(0,a.jsx)(v,{variant:"ghost",size:"icon",onClick:()=>{var s;return s=e.uid,void(null==o||o.removeCollaborator(l,i,s))},children:(0,a.jsx)(G.A,{className:"h-4 w-4 text-destructive"})})]},e.uid)),0===c.length&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center p-2",children:"Just you for now!"})]})]}),(0,a.jsx)($,{children:(0,a.jsx)(v,{variant:"secondary",onClick:t,children:"Done"})})]})})}let ep=e=>{let{listId:s}=e,t=(0,r.useContext)(n.B),[l,i]=(0,r.useState)(null),[d,c]=(0,r.useState)(!1),[o,m]=(0,r.useState)(!1),{user:x}=(0,A.useUser)(),u=null==t?void 0:t.lists.find(e=>e.id===s),h=(0,r.useMemo)(()=>{if(!u)return{};let e=u.items;(null==t?void 0:t.urgentMode)&&(e=u.items.filter(e=>e.urgent&&!e.checked));let s=e.reduce((e,s)=>{let t=s.checked?"Checked":s.category||"Other";return e[t]||(e[t]=[]),e[t].push(s),e},{}),a=Object.keys(s).sort((e,s)=>"Checked"===e?1:"Checked"===s?-1:e.localeCompare(s)),r={};for(let e of a)r[e]=s[e];return r},[u,null==t?void 0:t.urgentMode]);if(!t||!u)return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)(v,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>null==t?void 0:t.navigate({type:"lists"}),children:(0,a.jsx)(Y.A,{})}),"List not found."]});let{navigate:f,urgentMode:p,setUrgentMode:j,users:g}=t,N=(null==x?void 0:x.uid)===u.ownerId,y=u.collaborators.map(e=>g.find(s=>s.uid===e)).filter(Boolean);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-background/80 backdrop-blur-sm border-b z-10 p-2 flex items-center gap-2",children:[(0,a.jsx)(v,{variant:"ghost",size:"icon",onClick:()=>f({type:"lists"}),children:(0,a.jsx)(Y.A,{})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("h1",{className:"text-xl font-headline font-bold truncate",children:[u.icon," ",u.name]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[u.items.filter(e=>!e.checked).length," items remaining"]})]}),N&&(0,a.jsx)(v,{variant:"ghost",size:"icon",onClick:()=>m(!0),children:(0,a.jsx)(B.A,{className:"h-5 w-5"})}),(0,a.jsx)(v,{variant:"ghost",size:"icon",onClick:()=>f({type:"editList",listId:s}),children:(0,a.jsx)(b.A,{className:"h-5 w-5"})}),(0,a.jsx)(v,{variant:p?"destructive":"ghost",size:"icon",onClick:()=>j(!p),children:p?(0,a.jsx)(H.A,{className:"h-5 w-5"}):(0,a.jsx)(P.A,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"p-4 space-y-6",children:0===Object.keys(h).length?(0,a.jsx)("div",{className:"text-center py-20 text-muted-foreground",children:p?"No urgent items.":"This list is empty. Add an item!"}):Object.entries(h).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-headline font-semibold mb-2 pb-1 border-b-2 border-primary/30",children:t}),(0,a.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,a.jsx)(D,{item:e,listId:s,onEdit:()=>i(e)},e.id))})]},t)})}),(0,a.jsxs)("div",{className:"fixed bottom-24 right-4 flex flex-col-reverse items-center gap-3",children:[(0,a.jsx)(v,{size:"icon",className:"rounded-full h-16 w-16 shadow-lg",onClick:()=>i("new"),children:(0,a.jsx)(R.A,{className:"h-8 w-8"})}),(0,a.jsx)(v,{size:"icon",variant:"secondary",className:"rounded-full h-12 w-12 shadow-lg",onClick:()=>c(!0),children:(0,a.jsx)(O.A,{className:"h-6 w-6"})})]}),(0,a.jsx)(ei,{isOpen:!!l,onClose:()=>i(null),item:"new"===l?null:l,listId:s}),(0,a.jsx)(eh,{isOpen:d,onClose:()=>c(!1),listId:s}),(0,a.jsx)(ef,{isOpen:o,onClose:()=>m(!1),entityType:"list",entityId:s,ownerId:u.ownerId,collaborators:y})]})};var ej=t(5239);let eg=e=>{let{recipe:s}=e,t=(0,r.useContext)(n.B);if(!t)return null;let{navigate:l,users:i}=t,d=i.find(e=>e.uid===s.ownerId),c=s.collaborators.map(e=>i.find(s=>s.uid===e)).filter(Boolean);return(0,a.jsxs)(m,{className:"hover:shadow-md transition-shadow cursor-pointer overflow-hidden",onClick:()=>l({type:"recipeDetail",recipeId:s.id}),children:[(0,a.jsxs)(x,{className:"p-0 relative",children:[(0,a.jsx)(ej.default,{src:s.image,alt:s.name,width:600,height:400,className:"w-full h-32 object-cover","data-ai-hint":"food recipe"}),(0,a.jsxs)("div",{className:"absolute bottom-2 right-2 flex items-center gap-1",children:[d&&(0,a.jsxs)(w,{className:"h-6 w-6",children:[(0,a.jsx)(k,{src:d.photoURL,alt:d.name}),(0,a.jsx)(C,{children:d.name.charAt(0)})]}),c.map(e=>e&&(0,a.jsxs)(w,{className:"h-6 w-6 border-2 border-background",children:[(0,a.jsx)(k,{src:e.photoURL,alt:e.name}),(0,a.jsx)(C,{children:e.name.charAt(0)})]},e.uid))]})]}),(0,a.jsx)(f,{className:"p-4",children:(0,a.jsxs)(u,{className:"font-headline text-xl",children:[s.icon," ",s.name]})}),(0,a.jsx)(p,{className:"p-4 pt-0",children:(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s.ingredients.length," ingredients"]})})]})};var eN=t(7305),ev=t(3263),eb=t(5797);let ey=eN.bL,ew=eN.l9;eN.YJ,eN.ZL,eN.Pb,eN.z6,r.forwardRef((e,s)=>{let{className:t,inset:r,children:n,...l}=e;return(0,a.jsxs)(eN.ZP,{ref:s,className:(0,c.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",t),...l,children:[n,(0,a.jsx)(ev.A,{className:"ml-auto"})]})}).displayName=eN.ZP.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eN.G5,{ref:s,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}).displayName=eN.G5.displayName;let ek=r.forwardRef((e,s)=>{let{className:t,sideOffset:r=4,...n}=e;return(0,a.jsx)(eN.ZL,{children:(0,a.jsx)(eN.UC,{ref:s,sideOffset:r,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})});ek.displayName=eN.UC.displayName;let eC=r.forwardRef((e,s)=>{let{className:t,inset:r,...n}=e;return(0,a.jsx)(eN.q7,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",t),...n})});eC.displayName=eN.q7.displayName,r.forwardRef((e,s)=>{let{className:t,children:r,checked:n,...l}=e;return(0,a.jsxs)(eN.H_,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(eN.VF,{children:(0,a.jsx)(L.A,{className:"h-4 w-4"})})}),r]})}).displayName=eN.H_.displayName,r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(eN.hN,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(eN.VF,{children:(0,a.jsx)(eb.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=eN.hN.displayName,r.forwardRef((e,s)=>{let{className:t,inset:r,...n}=e;return(0,a.jsx)(eN.JU,{ref:s,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",t),...n})}).displayName=eN.JU.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eN.wv,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=eN.wv.displayName;let eA=()=>{let e=(0,r.useContext)(n.B);if(!e)return null;let{recipes:s,navigate:t}=e;return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("header",{className:"mb-6 flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-4xl font-headline font-bold",children:"Recipes"}),(0,a.jsxs)(ey,{children:[(0,a.jsx)(ew,{asChild:!0,children:(0,a.jsxs)(v,{children:[(0,a.jsx)(R.A,{className:"mr-2 h-4 w-4"})," Create Recipe"]})}),(0,a.jsxs)(ek,{children:[(0,a.jsxs)(eC,{onClick:()=>{t({type:"addRecipe"})},children:[(0,a.jsx)(O.A,{className:"mr-2 h-4 w-4"}),"Generate with AI"]}),(0,a.jsxs)(eC,{onClick:()=>{t({type:"editRecipe"})},children:[(0,a.jsx)(b.A,{className:"mr-2 h-4 w-4"}),"Create Manually"]})]})]})]}),0===s.length?(0,a.jsx)("div",{className:"text-center py-20 text-muted-foreground",children:(0,a.jsx)("p",{children:"You haven't saved any recipes yet."})}):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:s.map(e=>(0,a.jsx)(eg,{recipe:e},e.id))})]})};var eI=t(3630),eR=t(5218),eS=t(6015),ez=t(9007),eL=t(2614);let eM=eS.bL;eS.YJ;let eq=eS.WT,eU=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(eS.l9,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[r,(0,a.jsx)(eS.In,{asChild:!0,children:(0,a.jsx)(ez.A,{className:"h-4 w-4 opacity-50"})})]})});eU.displayName=eS.l9.displayName;let eE=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eS.PP,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(eL.A,{className:"h-4 w-4"})})});eE.displayName=eS.PP.displayName;let eD=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eS.wn,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(ez.A,{className:"h-4 w-4"})})});eD.displayName=eS.wn.displayName;let eY=r.forwardRef((e,s)=>{let{className:t,children:r,position:n="popper",...l}=e;return(0,a.jsx)(eS.ZL,{children:(0,a.jsxs)(eS.UC,{ref:s,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...l,children:[(0,a.jsx)(eE,{}),(0,a.jsx)(eS.LM,{className:(0,c.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(eD,{})]})})});eY.displayName=eS.UC.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eS.JU,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=eS.JU.displayName;let eB=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(eS.q7,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(eS.VF,{children:(0,a.jsx)(L.A,{className:"h-4 w-4"})})}),(0,a.jsx)(eS.p4,{children:r})]})});eB.displayName=eS.q7.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eS.wv,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=eS.wv.displayName;var eH=t(6463);let eP=eH.bL,eO=eH.l9,eF=eH.ZL,eJ=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eH.hJ,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:s})});eJ.displayName=eH.hJ.displayName;let eT=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsxs)(eF,{children:[(0,a.jsx)(eJ,{}),(0,a.jsx)(eH.UC,{ref:s,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r})]})});eT.displayName=eH.UC.displayName;let e_=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};e_.displayName="AlertDialogHeader";let eG=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};eG.displayName="AlertDialogFooter";let eV=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eH.hE,{ref:s,className:(0,c.cn)("text-lg font-semibold",t),...r})});eV.displayName=eH.hE.displayName;let eQ=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eH.VY,{ref:s,className:(0,c.cn)("text-sm text-muted-foreground",t),...r})});eQ.displayName=eH.VY.displayName;let eZ=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eH.rc,{ref:s,className:(0,c.cn)(N(),t),...r})});eZ.displayName=eH.rc.displayName;let eW=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eH.ZD,{ref:s,className:(0,c.cn)(N({variant:"outline"}),"mt-2 sm:mt-0",t),...r})});eW.displayName=eH.ZD.displayName;let eX=e=>{var s;let{recipeId:t}=e,l=(0,r.useContext)(n.B),{toast:i}=(0,en.dj)(),{user:d}=(0,A.useUser)(),c=null==l?void 0:l.recipes.find(e=>e.id===t),[o,m]=(0,r.useState)((null==l||null==(s=l.lists[0])?void 0:s.id)||null),[x,u]=(0,r.useState)(!1);if(!l||!c)return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)(v,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>null==l?void 0:l.navigate({type:"recipes"}),children:(0,a.jsx)(Y.A,{})}),"Recipe not found."]});let{navigate:h,lists:f,addRecipeToList:p,deleteRecipe:j,users:g}=l,N=(null==d?void 0:d.uid)===c.ownerId,y=c.collaborators.map(e=>g.find(s=>s.uid===e)).filter(Boolean);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"relative h-48",children:[(0,a.jsx)(ej.default,{src:c.image,alt:c.name,layout:"fill",objectFit:"cover",className:"w-full","data-ai-hint":"food recipe"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-background via-background/70 to-transparent"}),(0,a.jsx)("div",{className:"absolute top-2 left-2",children:(0,a.jsx)(v,{variant:"ghost",size:"icon",className:"bg-background/50 rounded-full",onClick:()=>h({type:"recipes"}),children:(0,a.jsx)(Y.A,{})})}),(0,a.jsx)("div",{className:"absolute bottom-4 left-4",children:(0,a.jsxs)("h1",{className:"text-4xl font-headline font-bold",children:[c.icon," ",c.name]})}),(0,a.jsx)("div",{className:"absolute top-2 right-2 flex gap-2",children:N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v,{variant:"ghost",size:"icon",className:"bg-background/50 rounded-full",onClick:()=>u(!0),children:(0,a.jsx)(B.A,{className:"h-5 w-5"})}),(0,a.jsx)(v,{variant:"ghost",size:"icon",className:"bg-background/50 rounded-full",onClick:()=>{h({type:"editRecipe",recipeId:c.id})},children:(0,a.jsx)(b.A,{className:"h-5 w-5"})}),(0,a.jsxs)(eP,{children:[(0,a.jsx)(eO,{asChild:!0,children:(0,a.jsx)(v,{variant:"destructive",size:"icon",className:"bg-background/50 rounded-full",children:(0,a.jsx)(eI.A,{className:"h-5 w-5"})})}),(0,a.jsxs)(eT,{children:[(0,a.jsxs)(e_,{children:[(0,a.jsx)(eV,{children:"Are you sure?"}),(0,a.jsxs)(eQ,{children:['This action cannot be undone. This will permanently delete the recipe for "',c.name,'".']})]}),(0,a.jsxs)(eG,{children:[(0,a.jsx)(eW,{children:"Cancel"}),(0,a.jsx)(eZ,{onClick:()=>{j(c.id)},children:"Delete"})]})]})]})]})})]}),(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-headline font-semibold mb-2",children:"Add to Shopping List"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(eM,{onValueChange:m,defaultValue:o||void 0,children:[(0,a.jsx)(eU,{className:"flex-1",children:(0,a.jsx)(eq,{placeholder:"Select a list"})}),(0,a.jsx)(eY,{children:f.map(e=>(0,a.jsxs)(eB,{value:e.id,children:[e.icon," ",e.name]},e.id))})]}),(0,a.jsxs)(v,{onClick:()=>{o?p(t,o):i({variant:"destructive",title:"No List Selected",description:"Please choose a list to add ingredients to."})},disabled:!f.length,children:[(0,a.jsx)(eR.A,{className:"mr-2 h-4 w-4"})," Add"]})]}),0===f.length&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"You need to create a shopping list first."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-headline font-semibold mb-2",children:"Ingredients"}),(0,a.jsx)("ul",{className:"space-y-2",children:c.ingredients.map(e=>(0,a.jsxs)("li",{className:"flex items-center gap-3 p-2 bg-muted/50 rounded-md",children:[(0,a.jsx)("span",{className:"text-xl",children:e.icon||"\uD83D\uDED2"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),e.notes&&(0,a.jsxs)("span",{className:"text-sm text-muted-foreground ml-2",children:["(",e.notes,")"]})]}),(0,a.jsxs)(U,{variant:"secondary",children:[e.qty," ",e.unit||""]})]},e.id))})]})]}),(0,a.jsx)(ef,{isOpen:x,onClose:()=>u(!1),entityType:"recipe",entityId:c.id,ownerId:c.ownerId,collaborators:y})]})};var eK=t(7599);let e$=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eK.bL,{className:(0,c.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...r,ref:s,children:(0,a.jsx)(eK.zi,{className:(0,c.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});e$.displayName=eK.bL.displayName;var e0=t(8428),e2=t(9253);let e1=()=>{var e;let s=(0,r.useContext)(n.B),{toast:t}=(0,en.dj)(),[l,i]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[o,p]=(0,r.useState)(""),{user:j}=(0,A.useUser)(),g=(0,A.useAuth)();if(!s)return null;let{settings:N,updateSettings:b}=s;return(0,a.jsxs)("div",{className:"p-4 space-y-6",children:[(0,a.jsx)("header",{children:(0,a.jsx)("h1",{className:"text-4xl font-headline font-bold",children:"Settings"})}),j&&(0,a.jsxs)(m,{children:[(0,a.jsx)(x,{children:(0,a.jsx)(u,{children:"My Profile"})}),(0,a.jsxs)(f,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(w,{className:"h-16 w-16",children:[(0,a.jsx)(k,{src:j.photoURL||void 0,alt:j.displayName||"user"}),(0,a.jsx)(C,{children:(null==(e=j.displayName)?void 0:e.charAt(0))||"U"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xl font-bold",children:j.displayName}),(0,a.jsx)("p",{className:"text-muted-foreground",children:j.email})]})]}),(0,a.jsxs)(v,{variant:"outline",onClick:()=>{(0,e2.CI)(g),t({title:"Signed Out",description:"You have been successfully signed out."})},children:[(0,a.jsx)(e0.A,{className:"mr-2 h-4 w-4"}),"Sign Out"]})]})]}),(0,a.jsxs)(m,{children:[(0,a.jsxs)(x,{children:[(0,a.jsx)(u,{children:"Presets"}),(0,a.jsx)(h,{children:"Manage your predefined stores and smart quantities."})]}),(0,a.jsxs)(f,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Store Presets"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(et,{placeholder:"New store name",value:l,onChange:e=>i(e.target.value)}),(0,a.jsxs)(v,{onClick:()=>{l&&!N.storePresets.includes(l)&&(b({storePresets:[...N.storePresets,l]}),i(""))},children:[(0,a.jsx)(R.A,{className:"h-4 w-4 mr-2"})," Add"]})]}),(0,a.jsx)("div",{className:"space-y-2 mt-2",children:N.storePresets.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted rounded-md",children:[(0,a.jsx)("span",{children:e}),(0,a.jsx)(v,{variant:"ghost",size:"icon",onClick:()=>{b({storePresets:N.storePresets.filter(s=>s!==e)})},children:(0,a.jsx)(eI.A,{className:"h-4 w-4 text-destructive"})})]},e))})]}),(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Smart Quantities"}),(0,a.jsx)("div",{className:"space-y-2",children:N.smartQuantities.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted rounded-md",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:e.itemName}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground ml-2",children:["(",e.quantities.join(", "),")"]})]}),(0,a.jsx)(v,{variant:"ghost",size:"icon",onClick:()=>{var s;return s=e.itemName,void b({smartQuantities:N.smartQuantities.filter(e=>e.itemName!==s)})},children:(0,a.jsx)(eI.A,{className:"h-4 w-4 text-destructive"})})]},e.itemName))}),(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsx)(et,{placeholder:"Item Name (e.g. 'Milk')",value:d,onChange:e=>c(e.target.value)}),(0,a.jsx)(et,{placeholder:"Quantities (e.g. 1, 2, 4)",value:o,onChange:e=>p(e.target.value)}),(0,a.jsxs)(v,{onClick:()=>{if(!d||!o)return void t({variant:"destructive",title:"Missing Info",description:"Please provide both an item name and quantities."});let e=o.split(",").map(e=>parseInt(e.trim())).filter(e=>!isNaN(e)&&e>0);if(0===e.length)return void t({variant:"destructive",title:"Invalid Quantities",description:"Please provide a comma-separated list of numbers."});b({smartQuantities:[...N.smartQuantities,{itemName:d,quantities:e}]}),c(""),p("")},children:[(0,a.jsx)(R.A,{className:"h-4 w-4 mr-2"})," Add"]})]})]})]})]}),(0,a.jsxs)(m,{children:[(0,a.jsxs)(x,{children:[(0,a.jsx)(u,{children:"Appearance & Behavior"}),(0,a.jsx)(h,{children:"Customize the look, feel, and functionality of the app."})]}),(0,a.jsxs)(f,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(ex,{htmlFor:"dark-mode",children:"Dark Mode"}),(0,a.jsx)(e$,{id:"dark-mode",checked:N.darkMode,onCheckedChange:e=>b({darkMode:e})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(ex,{htmlFor:"text-size",children:"Text Size"}),(0,a.jsxs)(eM,{value:N.textSize,onValueChange:e=>b({textSize:e}),children:[(0,a.jsx)(eU,{className:"w-[180px]",children:(0,a.jsx)(eq,{})}),(0,a.jsxs)(eY,{children:[(0,a.jsx)(eB,{value:"normal",children:"Normal"}),(0,a.jsx)(eB,{value:"large",children:"Large"})]})]})]})]})]})]})},e4=["\uD83D\uDED2","\uD83C\uDF4E","\uD83C\uDF89","\uD83C\uDFE0","\uD83D\uDCBB","\uD83C\uDF81","\uD83D\uDEE0️"],e5=()=>{let[e,s]=(0,r.useState)(""),[t,l]=(0,r.useState)("\uD83D\uDED2"),i=(0,r.useContext)(n.B);if(!i)return null;let{addList:d,navigate:c}=i;return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("header",{className:"flex items-center mb-6",children:[(0,a.jsx)(v,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>c({type:"lists"}),children:(0,a.jsx)(Y.A,{})}),(0,a.jsx)("h1",{className:"text-4xl font-headline font-bold",children:"New List"})]}),(0,a.jsxs)(m,{className:"max-w-md mx-auto",children:[(0,a.jsxs)(x,{children:[(0,a.jsx)(u,{children:"Create a List"}),(0,a.jsx)(h,{children:"Give your new shopping list a name and an icon."})]}),(0,a.jsxs)(f,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"list-name",className:"text-sm font-medium",children:"List Name"}),(0,a.jsx)(et,{id:"list-name",placeholder:"e.g., Weekly Groceries",value:e,onChange:e=>s(e.target.value),className:"text-lg"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Icon"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"text-4xl p-2 bg-muted rounded-lg",children:t}),(0,a.jsx)("div",{className:"flex-1 grid grid-cols-7 gap-1",children:e4.map(e=>(0,a.jsx)(v,{variant:t===e?"default":"outline",size:"icon",onClick:()=>l(e),children:e},e))})]})]})]}),(0,a.jsx)(p,{children:(0,a.jsx)(v,{className:"w-full",onClick:()=>{e.trim()&&d(e,t)},disabled:!e.trim(),children:"Create List"})})]})]})},e6=["\uD83D\uDED2","\uD83C\uDF4E","\uD83C\uDF89","\uD83C\uDFE0","\uD83D\uDCBB","\uD83C\uDF81","\uD83D\uDEE0️"],e8=e=>{let{listId:s}=e,t=(0,r.useContext)(n.B),l=null==t?void 0:t.lists.find(e=>e.id===s),[i,d]=(0,r.useState)((null==l?void 0:l.name)||""),[c,o]=(0,r.useState)((null==l?void 0:l.icon)||"\uD83D\uDED2");if((0,r.useEffect)(()=>{l&&(d(l.name),o(l.icon))},[l]),!t||!l)return null;let{updateList:j,deleteList:g,navigate:N}=t;return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("header",{className:"flex items-center mb-6",children:[(0,a.jsx)(v,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>N({type:"listDetail",listId:s}),children:(0,a.jsx)(Y.A,{})}),(0,a.jsx)("h1",{className:"text-4xl font-headline font-bold",children:"Edit List"})]}),(0,a.jsxs)(m,{className:"max-w-md mx-auto",children:[(0,a.jsxs)(x,{children:[(0,a.jsxs)(u,{children:['Edit "',l.name,'"']}),(0,a.jsx)(h,{children:"Update the name and icon for your list."})]}),(0,a.jsxs)(f,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"list-name",className:"text-sm font-medium",children:"List Name"}),(0,a.jsx)(et,{id:"list-name",placeholder:"e.g., Weekly Groceries",value:i,onChange:e=>d(e.target.value),className:"text-lg"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Icon"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"text-4xl p-2 bg-muted rounded-lg",children:c}),(0,a.jsx)("div",{className:"flex-1 grid grid-cols-7 gap-1",children:e6.map(e=>(0,a.jsx)(v,{variant:c===e?"default":"outline",size:"icon",onClick:()=>o(e),children:e},e))})]})]})]}),(0,a.jsxs)(p,{className:"flex justify-between",children:[(0,a.jsxs)(eP,{children:[(0,a.jsx)(eO,{asChild:!0,children:(0,a.jsx)(v,{variant:"destructive",size:"icon",children:(0,a.jsx)(eI.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(eT,{children:[(0,a.jsxs)(e_,{children:[(0,a.jsx)(eV,{children:"Are you sure?"}),(0,a.jsxs)(eQ,{children:['This will permanently delete the "',l.name,'" list and all its items. This action cannot be undone.']})]}),(0,a.jsxs)(eG,{children:[(0,a.jsx)(eW,{children:"Cancel"}),(0,a.jsx)(eZ,{onClick:()=>{g(s)},children:"Delete"})]})]})]}),(0,a.jsx)(v,{className:"flex-1 ml-4",onClick:()=>{i.trim()&&(j(s,i,c),N({type:"listDetail",listId:s}))},disabled:!i.trim(),children:"Save Changes"})]})]})]})};var e3=t(8772),e9=t(1929);let e7=JSON.parse('{"o":[{"id":"recipe-1","description":"Spaghetti Bolognese","imageUrl":"https://images.unsplash.com/photo-1693609930472-cf329a4d691b?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3NDE5ODJ8MHwxfHNlYXJjaHwxMHx8cGFzdGElMjBmb29kfGVufDB8fHx8MTc2NzE1MTQxMHww&ixlib=rb-4.1.0&q=80&w=1080","imageHint":"pasta food"},{"id":"recipe-2","description":"Chicken Curry","imageUrl":"https://images.unsplash.com/photo-1633271332313-04df64c0105b?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3NDE5ODJ8MHwxfHNlYXJjaHwzfHxjdXJyeSUyMGZvb2R8ZW58MHx8fHwxNzY3MjE1Njk3fDA&ixlib=rb-4.1.0&q=80&w=1080","imageHint":"curry food"},{"id":"recipe-3","description":"Taco Salad","imageUrl":"https://images.unsplash.com/photo-1623428186374-ef0f009bbd72?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3NDE5ODJ8MHwxfHNlYXJjaHwxMHx8c2FsYWQlMjBmb29kfGVufDB8fHx8MTc2NzEyNTY1N3ww&ixlib=rb-4.1.0&q=80&w=1080","imageHint":"salad food"},{"id":"recipe-4","description":"Pancakes","imageUrl":"https://images.unsplash.com/photo-1627876680112-4071fd0e50f6?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3NDE5ODJ8MHwxfHNlYXJjaHw2fHxwYW5jYWtlcyUyMGJyZWFrZmFzdHxlbnwwfHx8fDE3NjcxNjQ0ODN8MA&ixlib=rb-4.1.0&q=80&w=1080","imageHint":"pancakes breakfast"}]}').o,se=T.Ik({id:T.Yj(),name:T.Yj().min(1,"Ingredient name is required."),qty:T.ai().positive("Quantity must be a positive number."),unit:T.Yj().optional(),icon:T.Yj(),notes:T.Yj().optional()}),ss=T.Ik({name:T.Yj().min(1,"Recipe name is required."),icon:T.Yj().min(1,"Icon is required."),image:T.Yj().url("Must be a valid URL."),ingredients:T.YO(se).min(1,"At least one ingredient is required.")}),st=e=>{var s,t;let{recipeId:l}=e,i=(0,r.useContext)(n.B),{toast:d}=(0,en.dj)(),c=!!l,o=null==i?void 0:i.recipes.find(e=>e.id===l),j=null==i?void 0:i.generatedRecipe,g=(0,r.useRef)(null),{control:N,register:b,handleSubmit:y,reset:w,setValue:k,watch:C,formState:{errors:A}}=(0,F.mN)({resolver:(0,J.u)(ss),defaultValues:{name:"",icon:"\uD83C\uDF72",image:(null==(s=e7[Math.floor(Math.random()*e7.length)])?void 0:s.imageUrl)||"https://picsum.photos/seed/newrecipe/600/400",ingredients:[]}}),{fields:I,append:S,remove:z}=(0,F.jz)({control:N,name:"ingredients"}),L=C("image");if((0,r.useEffect)(()=>{if(c&&o){let e=o.ingredients.map(e=>({id:e.id,name:e.name,qty:e.qty,unit:e.unit||"",icon:e.icon||"\uD83D\uDED2",notes:e.notes||""}));w({name:o.name,icon:o.icon,image:o.image,ingredients:e})}else if(!c&&j){var e;w({name:j.name,icon:j.icon,image:(null==(e=e7[Math.floor(Math.random()*e7.length)])?void 0:e.imageUrl)||"https://picsum.photos/seed/newrecipe/600/400",ingredients:j.ingredients.map(e=>({...e,id:(0,e9.A)(),qty:e.qty||1,unit:e.unit||"",icon:e.icon||"\uD83D\uDED2",notes:e.notes||""}))})}},[c,o,j,w]),!i)return null;let{addRecipe:M,updateRecipe:q,navigate:U,clearGeneratedRecipe:E}=i;return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("header",{className:"flex items-center mb-6",children:[(0,a.jsx)(v,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>{c&&l?U({type:"recipeDetail",recipeId:l}):U({type:"recipes"}),E()},children:(0,a.jsx)(Y.A,{})}),(0,a.jsx)("h1",{className:"text-4xl font-headline font-bold",children:c?"Edit Recipe":"New Recipe"})]}),(0,a.jsx)("form",{onSubmit:y(e=>{let s={...e,ingredients:e.ingredients.map(e=>({...e,category:"",checked:!1,urgent:!1,gf:!1,store:"",canonicalName:e.name}))};c&&l?(q({...s,id:l}),d({title:"Recipe Updated",description:'"'.concat(e.name,'" has been saved.')})):(M(s),d({title:"Recipe Created",description:'"'.concat(e.name,'" has been added.')})),E()}),children:(0,a.jsxs)(m,{className:"max-w-xl mx-auto",children:[(0,a.jsxs)(x,{children:[(0,a.jsx)(u,{children:"Recipe Details"}),(0,a.jsx)(h,{children:c?"Update the information for your recipe.":"Review and save your generated recipe."})]}),(0,a.jsxs)(f,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(et,{...b("icon"),className:"text-3xl w-16 h-16 p-0 text-center bg-muted",maxLength:2}),(0,a.jsx)(et,{...b("name"),placeholder:"Recipe Name",className:"text-2xl font-headline font-bold h-16 flex-1"})]}),A.name&&(0,a.jsx)("p",{className:"text-destructive text-sm",children:A.name.message}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Recipe Image"}),(0,a.jsxs)("div",{className:"mt-1",children:[(0,a.jsx)("input",{type:"file",accept:"image/*",ref:g,className:"hidden",onChange:e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(t){let e=new FileReader;e.onloadend=()=>{k("image",e.result,{shouldValidate:!0})},e.readAsDataURL(t)}}}),L&&(0,a.jsx)("div",{className:"mb-2 relative",children:(0,a.jsx)(ej.default,{src:L,alt:"Recipe Preview",width:600,height:400,className:"w-full h-48 object-cover rounded-md"})}),(0,a.jsxs)(v,{type:"button",variant:"outline",onClick:()=>{var e;return null==(e=g.current)?void 0:e.click()},children:[(0,a.jsx)(e3.A,{className:"mr-2 h-4 w-4"}),L?"Change Image":"Upload Image"]})]}),A.image&&(0,a.jsx)("p",{className:"text-destructive text-sm",children:A.image.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Ingredients"}),(0,a.jsxs)("div",{className:"space-y-2",children:[I.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-muted rounded-md",children:[(0,a.jsx)(F.xI,{control:N,name:"ingredients.".concat(s,".icon"),render:e=>{let{field:s}=e;return(0,a.jsx)(et,{...s,className:"w-12 h-12 text-2xl text-center p-0"})}}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)(F.xI,{control:N,name:"ingredients.".concat(s,".name"),render:e=>{let{field:s}=e;return(0,a.jsx)(et,{...s,placeholder:"Ingredient Name"})}}),(0,a.jsx)(F.xI,{control:N,name:"ingredients.".concat(s,".notes"),render:e=>{let{field:s}=e;return(0,a.jsx)(et,{...s,placeholder:"Notes (e.g. 'diced')",className:"text-xs h-7"})}})]}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(F.xI,{control:N,name:"ingredients.".concat(s,".qty"),render:e=>{let{field:s}=e;return(0,a.jsx)(et,{...s,type:"number",step:"0.01",className:"w-16",min:0,onChange:e=>s.onChange(parseFloat(e.target.value)||0)})}}),(0,a.jsx)(F.xI,{control:N,name:"ingredients.".concat(s,".unit"),render:e=>{let{field:s}=e;return(0,a.jsx)(et,{...s,placeholder:"Unit",className:"w-16"})}})]}),(0,a.jsx)(v,{type:"button",variant:"destructive",size:"icon",onClick:()=>z(s),children:(0,a.jsx)(eI.A,{className:"h-4 w-4"})})]},e.id)),A.ingredients&&(0,a.jsx)("p",{className:"text-destructive text-sm",children:A.ingredients.message||(null==(t=A.ingredients.root)?void 0:t.message)})]}),(0,a.jsxs)(v,{type:"button",variant:"outline",className:"mt-2 w-full",onClick:()=>S({id:(0,e9.A)(),name:"",qty:1,unit:"",icon:"\uD83D\uDED2",notes:""}),children:[(0,a.jsx)(R.A,{className:"mr-2 h-4 w-4"})," Add Ingredient"]})]})]}),(0,a.jsx)(p,{children:(0,a.jsx)(v,{type:"submit",className:"w-full",children:c?"Save Changes":"Create Recipe"})})]})})]})},sa=()=>{let[e,s]=(0,r.useState)(""),[t,l]=(0,r.useState)(!1),i=(0,r.useContext)(n.B),{toast:d}=(0,en.dj)();if(!i)return null;let{navigate:c,setGeneratedRecipe:o}=i,j=async()=>{if(!e.trim())return void d({variant:"destructive",title:"Recipe name is empty"});l(!0);try{let s=await fetch("/api/generate-recipe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({recipeName:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to generate recipe.")}let t=await s.json();o(t),c({type:"editRecipe"})}catch(e){console.error("AI recipe generation failed:",e),d({variant:"destructive",title:"AI Error",description:e.message||"Could not generate the recipe."})}finally{l(!1)}};return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("header",{className:"flex items-center mb-6",children:[(0,a.jsx)(v,{variant:"ghost",size:"icon",className:"mr-2",onClick:()=>c({type:"recipes"}),children:(0,a.jsx)(Y.A,{})}),(0,a.jsx)("h1",{className:"text-4xl font-headline font-bold",children:"Generate Recipe"})]}),(0,a.jsxs)(m,{className:"max-w-md mx-auto",children:[(0,a.jsxs)(x,{children:[(0,a.jsxs)(u,{className:"flex items-center gap-2",children:[(0,a.jsx)(O.A,{})," AI Recipe Generator"]}),(0,a.jsx)(h,{children:"Enter the name of a dish, and Gemini will create a recipe for you."})]}),(0,a.jsx)(f,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"recipe-name",className:"text-sm font-medium",children:"Recipe Name"}),(0,a.jsx)(et,{id:"recipe-name",placeholder:"e.g., Chocolate Chip Cookies",value:e,onChange:e=>s(e.target.value),className:"text-lg",onKeyDown:e=>"Enter"===e.key&&j()})]})}),(0,a.jsx)(p,{children:(0,a.jsx)(v,{className:"w-full",onClick:j,disabled:t,children:t?"Generating...":"Generate Recipe"})})]})]})};var sr=t(1165);let sn=e=>{let{item:s}=e;return(0,a.jsxs)("div",{className:"p-3 bg-muted rounded-md text-left w-full",children:[(0,a.jsxs)("div",{className:"font-bold flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:s.icon}),s.name]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground pl-8",children:[s.qty," ",s.unit,s.store&&" from ".concat(s.store),s.notes&&" (".concat(s.notes,")")]})]})};function sl(){let e=(0,r.useContext)(n.B);if(!e||!e.mergeProposal)return null;let{mergeProposal:s,confirmMerge:t,declineMerge:l}=e,{existingItem:i,newItemData:d}=s;return(0,a.jsx)(V,{open:!!s,onOpenChange:e=>!e&&l(!1),children:(0,a.jsxs)(X,{children:[(0,a.jsxs)(K,{children:[(0,a.jsx)(ee,{children:"Merge These Items?"}),(0,a.jsx)(es,{children:"You're adding an item that's very similar to one already on your list."})]}),(0,a.jsxs)("div",{className:"my-4 flex flex-col items-center gap-2",children:[(0,a.jsx)(sn,{item:d}),(0,a.jsx)("div",{className:"text-muted-foreground font-bold my-1",children:"+"}),(0,a.jsx)(sn,{item:i}),(0,a.jsx)(sr.A,{className:"my-2 text-primary h-6 w-6"}),(0,a.jsx)("div",{className:"font-bold text-lg self-start",children:"Combined Result:"}),(0,a.jsx)(sn,{item:{...d,name:i.name,icon:i.icon,qty:(i.qty||0)+(d.qty||0),store:(i.store||d.store||"").trim()}})]}),(0,a.jsxs)($,{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(v,{variant:"outline",onClick:()=>l(!0),children:"Keep Separate"}),(0,a.jsx)(v,{onClick:t,children:"Yes, Merge"})]})]})})}let si=()=>{let e=(0,r.useContext)(n.B);if(!e)return null;let{currentView:s}=e;return(0,a.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,a.jsx)("main",{className:"flex-1 overflow-y-auto pb-20",children:(()=>{switch(s.type){case"lists":default:return(0,a.jsx)(S,{});case"listDetail":return(0,a.jsx)(ep,{listId:s.listId});case"recipes":return(0,a.jsx)(eA,{});case"recipeDetail":return(0,a.jsx)(eX,{recipeId:s.recipeId});case"settings":return(0,a.jsx)(e1,{});case"addList":return(0,a.jsx)(e5,{});case"editList":return(0,a.jsx)(e8,{listId:s.listId});case"addRecipe":return(0,a.jsx)(sa,{});case"editRecipe":return(0,a.jsx)(st,{recipeId:s.recipeId})}})()}),(0,a.jsx)(sl,{}),(0,a.jsx)(o,{})]})};function sd(e){let{children:s,className:t}=e;return(0,a.jsx)("div",{className:(0,c.cn)("overflow-y-auto",t),style:{maskImage:"linear-gradient(to bottom, transparent 0%, black 10%, black 90%, transparent 100%)",WebkitMaskImage:"linear-gradient(to bottom, transparent 0%, black 10%, black 90%, transparent 100%)"},children:s})}let sc=()=>{let e=(0,r.useContext)(n.B);if(!e)return null;let{lists:s,navigate:t}=e;return(0,a.jsxs)("div",{className:"pt-8 text-center",children:[(0,a.jsx)("h1",{className:"text-xl font-bold font-headline mb-4",children:"PantryPal"}),(0,a.jsx)(sd,{children:s.length>0?(0,a.jsx)("div",{className:"flex flex-col gap-2 px-2",children:s.map(e=>(0,a.jsxs)(v,{variant:"secondary",className:"w-full justify-start text-lg h-14",onClick:()=>t({type:"listDetail",listId:e.id}),children:[(0,a.jsx)("span",{className:"text-2xl mr-3",children:e.icon}),e.name]},e.id))}):(0,a.jsx)("p",{className:"text-muted-foreground mt-12",children:"No lists found. Please create a list on your phone."})})]})},so=e=>{let{item:s,listId:t}=e,l=(0,r.useContext)(n.B);if(!l)return null;let{toggleItemChecked:i}=l;return(0,a.jsxs)("div",{onClick:()=>i(t,s.id),className:(0,c.cn)("flex items-center gap-2 p-2 rounded-lg",s.checked?"bg-gray-800/50 opacity-50":"bg-gray-800",s.urgent&&!s.checked&&"border border-destructive"),children:[(0,a.jsx)("span",{className:"text-2xl",children:s.icon}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("span",{className:(0,c.cn)("text-lg",s.checked&&"line-through"),children:s.name})}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[s.gf&&(0,a.jsx)(E.A,{className:"h-4 w-4 text-green-400"}),s.qty>1&&(0,a.jsxs)(U,{className:"bg-gray-600 text-white",children:["x",s.qty]})]})]})},sm=e=>{let{listId:s}=e,t=(0,r.useContext)(n.B),l=null==t?void 0:t.lists.find(e=>e.id===s),i=(0,r.useMemo)(()=>{if(!l)return{};let e=l.items;(null==t?void 0:t.urgentMode)&&(e=l.items.filter(e=>e.urgent&&!e.checked));let s=e.reduce((e,s)=>{let t=s.checked?"Checked":s.category||"Other";return e[t]||(e[t]=[]),e[t].push(s),e},{}),a=Object.keys(s).sort((e,s)=>"Checked"===e?1:"Checked"===s?-1:e.localeCompare(s)),r={};return a.forEach(e=>{r[e]=s[e]}),r},[l,null==t?void 0:t.urgentMode]);if(!t||!l)return null;let{navigate:d,urgentMode:c,setUrgentMode:o}=t;return(0,a.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,a.jsxs)("header",{className:"pt-8 px-2 flex items-center justify-between",children:[(0,a.jsx)(v,{variant:"ghost",size:"icon",className:"rounded-full",onClick:()=>d({type:"lists"}),children:(0,a.jsx)(Y.A,{className:"h-6 w-6"})}),(0,a.jsxs)("h1",{className:"text-lg font-bold font-headline truncate flex-1 text-center",children:[l.icon," ",l.name]}),(0,a.jsx)("div",{className:"w-10 h-10"})," "]}),(0,a.jsx)(sd,{className:"flex-1 my-2",children:0===Object.keys(i).length?(0,a.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:c?"No urgent items.":"List is empty or all items are checked."}):(0,a.jsx)("div",{className:"space-y-4 px-2",children:Object.entries(i).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-md font-semibold text-primary/80 mb-1",children:t}),(0,a.jsx)("div",{className:"space-y-1",children:r.map(e=>(0,a.jsx)(so,{item:e,listId:s},e.id))})]},t)})})}),(0,a.jsx)("div",{className:"p-2 border-t border-gray-800",children:(0,a.jsxs)(v,{className:"w-full h-12 text-lg",variant:c?"destructive":"secondary",onClick:()=>o(!c),children:[c?(0,a.jsx)(H.A,{className:"mr-2"}):(0,a.jsx)(P.A,{className:"mr-2"}),"Urgent"]})})]})},sx=()=>{let e=(0,r.useContext)(n.B);if(!e)return null;let{currentView:s}=e;return(0,a.jsx)("div",{className:"bg-black text-white min-h-screen w-full font-sans",children:"listDetail"===s.type?(0,a.jsx)(sm,{listId:s.listId}):(0,a.jsx)(sc,{})})};function su(e){let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,c.cn)("animate-pulse rounded-md bg-muted",s),...t})}var sh=t(9708),sf=t(5742);let sp=()=>{let e=(0,A.useAuth)(),s=(0,A.useFirestore)(),{toast:t}=(0,en.dj)(),r=async()=>{let a=new e2.HF;try{let r=(await (0,e2.df)(e,a)).user,n=(0,sh.H9)(s,"users",r.uid);(0,sf.wu)(n,{uid:r.uid,name:r.displayName,email:r.email,photoURL:r.photoURL},{merge:!0});let l=localStorage.getItem("smartlist_lists"),i=localStorage.getItem("smartlist_recipes");if(l||i){let e=(0,sh.wP)(s);l&&JSON.parse(l).forEach(t=>{let a=(0,sh.H9)((0,sh.rJ)(s,"lists"));e.set(a,{...t,ownerId:r.uid,collaborators:[]})}),i&&JSON.parse(i).forEach(t=>{let a=(0,sh.H9)((0,sh.rJ)(s,"recipes"));e.set(a,{...t,ownerId:r.uid,collaborators:[]})}),await e.commit(),localStorage.removeItem("smartlist_lists"),localStorage.removeItem("smartlist_recipes"),localStorage.removeItem("smartlist_settings"),t({title:"Data Migrated",description:"Your local lists and recipes have been moved to your account."})}}catch(e){console.error("Google Sign-In Error:",e),t({variant:"destructive",title:"Sign-In Failed",description:"Could not sign in with Google."})}};return(0,a.jsx)("div",{className:"flex items-center justify-center h-screen bg-background",children:(0,a.jsxs)(m,{className:"w-[350px]",children:[(0,a.jsxs)(x,{className:"text-center",children:[(0,a.jsx)(u,{children:"Welcome to PantryPal"}),(0,a.jsx)(h,{children:"Sign in to continue"})]}),(0,a.jsx)(f,{children:(0,a.jsx)(v,{className:"w-full",onClick:r,children:"Sign in with Google"})})]})})};function sj(){var e,s;let t=function(){let[e,s]=r.useState(void 0);return r.useEffect(()=>{let e=()=>{s(window.innerWidth<300)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}(),l=(0,r.useContext)(n.B),{user:i,isUserLoading:d}=(0,A.useUser)();return((0,r.useEffect)(()=>{l&&l.settings&&(document.body.classList.toggle("dark",l.settings.darkMode),document.body.classList.toggle("text-lg","large"===l.settings.textSize),document.body.classList.toggle("urgent-mode",l.urgentMode))},[null==l||null==(e=l.settings)?void 0:e.darkMode,null==l||null==(s=l.settings)?void 0:s.textSize,null==l?void 0:l.urgentMode]),d||(null==l?void 0:l.isDataLoading))?(0,a.jsx)("div",{className:"w-screen h-screen p-4",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,a.jsx)(su,{className:"h-[125px] w-full rounded-xl"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(su,{className:"h-4 w-full"}),(0,a.jsx)(su,{className:"h-4 w-4/5"})]})]})}):i?void 0!==t&&l?t?(0,a.jsx)(sx,{}):(0,a.jsx)(si,{}):(0,a.jsx)("div",{className:"w-screen h-screen p-4",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,a.jsx)(su,{className:"h-[125px] w-full rounded-xl"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(su,{className:"h-4 w-full"}),(0,a.jsx)(su,{className:"h-4 w-4/5"})]})]})}):(0,a.jsx)(sp,{})}}},e=>{e.O(0,[992,644,747,168,272,441,255,358],()=>e(e.s=9144)),_N_E=e.O()}]);